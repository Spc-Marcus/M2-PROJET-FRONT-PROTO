<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duobingo API Tester</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a2e;
            color: #eee;
            min-height: 100vh;
        }
        .container {
            display: flex;
            min-height: 100vh;
        }
        /* Sidebar */
        .sidebar {
            width: 280px;
            background: #16213e;
            padding: 20px;
            overflow-y: auto;
            border-right: 1px solid #0f3460;
        }
        .sidebar h1 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #e94560;
        }
        .nav-section {
            margin-bottom: 15px;
        }
        .nav-section h3 {
            font-size: 0.85rem;
            color: #888;
            text-transform: uppercase;
            margin-bottom: 8px;
        }
        .nav-item {
            padding: 8px 12px;
            margin: 2px 0;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s;
        }
        .nav-item:hover {
            background: #0f3460;
        }
        .nav-item.active {
            background: #e94560;
        }
        .method-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-right: 6px;
        }
        .method-GET { background: #61affe; color: #000; }
        .method-POST { background: #49cc90; color: #000; }
        .method-PUT, .method-PATCH { background: #fca130; color: #000; }
        .method-DELETE { background: #f93e3e; color: #fff; }

        /* Main Content */
        .main {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #333;
        }
        .auth-section {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .auth-section input {
            width: 300px;
        }
        .token-status {
            font-size: 0.8rem;
            padding: 5px 10px;
            border-radius: 4px;
        }
        .token-status.valid { background: #49cc90; color: #000; }
        .token-status.invalid { background: #f93e3e; }

        /* Endpoint Panel */
        .endpoint-panel {
            background: #16213e;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }
        .endpoint-title {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .endpoint-title h2 {
            font-size: 1.1rem;
        }
        .endpoint-path {
            font-family: monospace;
            background: #0f3460;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.85rem;
            color: #aaa;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #333;
            border-radius: 6px;
            background: #1a1a2e;
            color: #eee;
            font-size: 0.9rem;
        }
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #e94560;
        }
        textarea {
            font-family: monospace;
            min-height: 150px;
            resize: vertical;
        }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: opacity 0.2s;
        }
        button:hover {
            opacity: 0.85;
        }
        .btn-primary {
            background: #e94560;
            color: #fff;
        }
        .btn-secondary {
            background: #0f3460;
            color: #fff;
        }

        /* Response Section */
        .response-section {
            margin-top: 20px;
        }
        .response-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .response-status {
            font-size: 0.9rem;
            padding: 5px 12px;
            border-radius: 4px;
        }
        .status-2xx { background: #49cc90; color: #000; }
        .status-4xx { background: #fca130; color: #000; }
        .status-5xx { background: #f93e3e; }
        .response-body {
            background: #0d1b2a;
            border-radius: 6px;
            padding: 15px;
            font-family: monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 400px;
            overflow-y: auto;
        }
        .response-time {
            font-size: 0.8rem;
            color: #888;
        }

        /* Params Grid */
        .params-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #fff;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <h1>üéØ Duobingo API</h1>
            
            <div class="nav-section">
                <h3>Auth & Users</h3>
                <div class="nav-item" data-endpoint="login">
                    <span class="method-badge method-POST">POST</span>/auth/login
                </div>
                <div class="nav-item" data-endpoint="register">
                    <span class="method-badge method-POST">POST</span>/auth/register
                </div>
                <div class="nav-item" data-endpoint="getMe">
                    <span class="method-badge method-GET">GET</span>/users/me
                </div>
                <div class="nav-item" data-endpoint="updateMe">
                    <span class="method-badge method-PATCH">PATCH</span>/users/me
                </div>
                <div class="nav-item" data-endpoint="createUser">
                    <span class="method-badge method-POST">POST</span>/admin/users
                </div>
            </div>

            <div class="nav-section">
                <h3>Classrooms</h3>
                <div class="nav-item" data-endpoint="listClassrooms">
                    <span class="method-badge method-GET">GET</span>/classrooms
                </div>
                <div class="nav-item" data-endpoint="createClassroom">
                    <span class="method-badge method-POST">POST</span>/classrooms
                </div>
                <div class="nav-item" data-endpoint="getClassroom">
                    <span class="method-badge method-GET">GET</span>/classrooms/{id}
                </div>
                <div class="nav-item" data-endpoint="updateClassroom">
                    <span class="method-badge method-PATCH">PATCH</span>/classrooms/{id}
                </div>
                <div class="nav-item" data-endpoint="deleteClassroom">
                    <span class="method-badge method-DELETE">DELETE</span>/classrooms/{id}
                </div>
                <div class="nav-item" data-endpoint="getMembers">
                    <span class="method-badge method-GET">GET</span>/classrooms/{id}/members
                </div>
                <div class="nav-item" data-endpoint="addTeacher">
                    <span class="method-badge method-POST">POST</span>/classrooms/{id}/teachers
                </div>
                <div class="nav-item" data-endpoint="removeTeacher">
                    <span class="method-badge method-DELETE">DELETE</span>/.../teachers/{tid}
                </div>
                <div class="nav-item" data-endpoint="enrollStudent">
                    <span class="method-badge method-POST">POST</span>/classrooms/{id}/enroll
                </div>
                <div class="nav-item" data-endpoint="removeStudent">
                    <span class="method-badge method-DELETE">DELETE</span>/.../students/{sid}
                </div>
                <div class="nav-item" data-endpoint="joinClassroom">
                    <span class="method-badge method-POST">POST</span>/classrooms/{id}/join
                </div>
                <div class="nav-item" data-endpoint="regenerateCode">
                    <span class="method-badge method-POST">POST</span>/.../regenerate-code
                </div>
            </div>

            <div class="nav-section">
                <h3>Modules</h3>
                <div class="nav-item" data-endpoint="listModules">
                    <span class="method-badge method-GET">GET</span>/classrooms/{cid}/modules
                </div>
                <div class="nav-item" data-endpoint="createModule">
                    <span class="method-badge method-POST">POST</span>/classrooms/{cid}/modules
                </div>
                <div class="nav-item" data-endpoint="updateModule">
                    <span class="method-badge method-PUT">PUT</span>/modules/{id}
                </div>
                <div class="nav-item" data-endpoint="deleteModule">
                    <span class="method-badge method-DELETE">DELETE</span>/modules/{id}
                </div>
            </div>

            <div class="nav-section">
                <h3>Quizzes</h3>
                <div class="nav-item" data-endpoint="listQuizzes">
                    <span class="method-badge method-GET">GET</span>/modules/{mid}/quizzes
                </div>
                <div class="nav-item" data-endpoint="createQuiz">
                    <span class="method-badge method-POST">POST</span>/modules/{mid}/quizzes
                </div>
                <div class="nav-item" data-endpoint="updateQuiz">
                    <span class="method-badge method-PUT">PUT</span>/quizzes/{id}
                </div>
                <div class="nav-item" data-endpoint="deleteQuiz">
                    <span class="method-badge method-DELETE">DELETE</span>/quizzes/{id}
                </div>
            </div>

            <div class="nav-section">
                <h3>Questions</h3>
                <div class="nav-item" data-endpoint="listQuestions">
                    <span class="method-badge method-GET">GET</span>/quizzes/{qid}/questions
                </div>
                <div class="nav-item" data-endpoint="createQuestion">
                    <span class="method-badge method-POST">POST</span>/quizzes/{qid}/questions
                </div>
                <div class="nav-item" data-endpoint="updateQuestion">
                    <span class="method-badge method-PUT">PUT</span>/questions/{id}
                </div>
                <div class="nav-item" data-endpoint="deleteQuestion">
                    <span class="method-badge method-DELETE">DELETE</span>/questions/{id}
                </div>
            </div>

            <div class="nav-section">
                <h3>Media</h3>
                <div class="nav-item" data-endpoint="listMedia">
                    <span class="method-badge method-GET">GET</span>/media
                </div>
                <div class="nav-item" data-endpoint="uploadMedia">
                    <span class="method-badge method-POST">POST</span>/media
                </div>
                <div class="nav-item" data-endpoint="deleteMedia">
                    <span class="method-badge method-DELETE">DELETE</span>/media/{id}
                </div>
                <div class="nav-item" data-endpoint="orphanedMedia">
                    <span class="method-badge method-GET">GET</span>/media/orphaned
                </div>
            </div>

            <div class="nav-section">
                <h3>Sessions (Gameplay)</h3>
                <div class="nav-item" data-endpoint="startSession">
                    <span class="method-badge method-POST">POST</span>/sessions/start
                </div>
                <div class="nav-item" data-endpoint="submitAnswer">
                    <span class="method-badge method-POST">POST</span>/sessions/{sid}/submit
                </div>
                <div class="nav-item" data-endpoint="finishSession">
                    <span class="method-badge method-POST">POST</span>/sessions/{sid}/finish
                </div>
                <div class="nav-item" data-endpoint="reviewSession">
                    <span class="method-badge method-GET">GET</span>/sessions/{sid}/review
                </div>
            </div>

            <div class="nav-section">
                <h3>Leitner</h3>
                <div class="nav-item" data-endpoint="leitnerStatus">
                    <span class="method-badge method-GET">GET</span>/.../leitner/status
                </div>
                <div class="nav-item" data-endpoint="leitnerStart">
                    <span class="method-badge method-POST">POST</span>/.../leitner/start
                </div>
                <div class="nav-item" data-endpoint="leitnerSubmit">
                    <span class="method-badge method-POST">POST</span>/leitner/.../submit
                </div>
                <div class="nav-item" data-endpoint="leitnerFinish">
                    <span class="method-badge method-POST">POST</span>/leitner/.../finish
                </div>
                <div class="nav-item" data-endpoint="leitnerReview">
                    <span class="method-badge method-GET">GET</span>/leitner/.../review
                </div>
            </div>

            <div class="nav-section">
                <h3>Stats & Progress</h3>
                <div class="nav-item" data-endpoint="studentStats">
                    <span class="method-badge method-GET">GET</span>/stats/student
                </div>
                <div class="nav-item" data-endpoint="leaderboard">
                    <span class="method-badge method-GET">GET</span>/stats/leaderboard/{cid}
                </div>
                <div class="nav-item" data-endpoint="dashboard">
                    <span class="method-badge method-GET">GET</span>/stats/dashboard/{cid}
                </div>
                <div class="nav-item" data-endpoint="progressModule">
                    <span class="method-badge method-GET">GET</span>/progress/modules/{mid}
                </div>
                <div class="nav-item" data-endpoint="progressQuiz">
                    <span class="method-badge method-GET">GET</span>/progress/quizzes/{qid}
                </div>
                <div class="nav-item" data-endpoint="progressClassroom">
                    <span class="method-badge method-GET">GET</span>/progress/classroom/{cid}
                </div>
                <div class="nav-item" data-endpoint="progressStudent">
                    <span class="method-badge method-GET">GET</span>/progress/.../student/{sid}
                </div>
            </div>
        </nav>

        <main class="main">
            <div class="header">
                <h2>üîå API Tester</h2>
                <div class="auth-section">
                    <input type="text" id="jwtToken" placeholder="JWT Token (se remplit apr√®s login)">
                    <span id="tokenStatus" class="token-status invalid">Non connect√©</span>
                </div>
            </div>

            <div id="endpointPanel" class="endpoint-panel">
                <p style="color: #888; text-align: center; padding: 50px;">
                    ‚Üê S√©lectionnez un endpoint dans le menu
                </p>
            </div>
        </main>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000/api';
        
        // D√©finition des endpoints
        const endpoints = {
            // Auth & Users
            login: {
                method: 'POST',
                path: '/auth/login',
                description: 'Connexion (retourne un JWT)',
                body: { email: 'user@univ-rennes.fr', password: 'password123' }
            },
            register: {
                method: 'POST',
                path: '/auth/register',
                description: 'Inscription √©tudiant',
                body: { email: 'etudiant@univ-rennes.fr', password: 'password123', name: 'Jean Dupont', level: 'L1' }
            },
            getMe: {
                method: 'GET',
                path: '/users/me',
                description: 'R√©cup√©rer le profil connect√©',
                auth: true
            },
            updateMe: {
                method: 'PATCH',
                path: '/users/me',
                description: 'Modifier son profil',
                auth: true,
                body: { email: 'newemail@univ.fr' }
            },
            createUser: {
                method: 'POST',
                path: '/admin/users',
                description: 'Cr√©er un compte Prof/Admin',
                auth: true,
                body: { email: 'prof@univ.fr', password: 'password123', role: 'TEACHER', name: 'Dr. House' }
            },
            
            // Classrooms
            listClassrooms: {
                method: 'GET',
                path: '/classrooms',
                description: 'Liste des cours',
                auth: true
            },
            createClassroom: {
                method: 'POST',
                path: '/classrooms',
                description: 'Cr√©er un cours',
                auth: true,
                body: { name: 'Anatomie L1', level: 'L1' }
            },
            getClassroom: {
                method: 'GET',
                path: '/classrooms/{id}',
                description: 'D√©tails d\'un cours',
                auth: true,
                params: [{ name: 'id', label: 'Classroom ID (UUID)' }]
            },
            updateClassroom: {
                method: 'PATCH',
                path: '/classrooms/{id}',
                description: 'Modifier un cours',
                auth: true,
                params: [{ name: 'id', label: 'Classroom ID (UUID)' }],
                body: { name: 'Nouveau nom', level: 'L2' }
            },
            deleteClassroom: {
                method: 'DELETE',
                path: '/classrooms/{id}',
                description: 'Supprimer un cours',
                auth: true,
                params: [{ name: 'id', label: 'Classroom ID (UUID)' }]
            },
            getMembers: {
                method: 'GET',
                path: '/classrooms/{id}/members',
                description: 'Lister les membres',
                auth: true,
                params: [{ name: 'id', label: 'Classroom ID (UUID)' }]
            },
            addTeacher: {
                method: 'POST',
                path: '/classrooms/{id}/teachers',
                description: 'Ajouter un enseignant',
                auth: true,
                params: [{ name: 'id', label: 'Classroom ID (UUID)' }],
                body: { email: 'teacher@univ.fr' }
            },
            removeTeacher: {
                method: 'DELETE',
                path: '/classrooms/{id}/teachers/{teacherId}',
                description: 'Retirer un enseignant',
                auth: true,
                params: [
                    { name: 'id', label: 'Classroom ID (UUID)' },
                    { name: 'teacherId', label: 'Teacher ID (UUID)' }
                ]
            },
            enrollStudent: {
                method: 'POST',
                path: '/classrooms/{id}/enroll',
                description: 'Inscrire un √©tudiant',
                auth: true,
                params: [{ name: 'id', label: 'Classroom ID (UUID)' }],
                body: { email: 'student@univ.fr' }
            },
            removeStudent: {
                method: 'DELETE',
                path: '/classrooms/{id}/students/{studentId}',
                description: 'Retirer un √©tudiant',
                auth: true,
                params: [
                    { name: 'id', label: 'Classroom ID (UUID)' },
                    { name: 'studentId', label: 'Student ID (UUID)' }
                ]
            },
            joinClassroom: {
                method: 'POST',
                path: '/classrooms/{id}/join',
                description: 'Rejoindre un cours (via code)',
                auth: true,
                params: [{ name: 'id', label: 'Classroom ID (UUID)' }],
                body: { code: 'ABC123' }
            },
            regenerateCode: {
                method: 'POST',
                path: '/classrooms/{id}/regenerate-code',
                description: 'R√©g√©n√©rer le code d\'acc√®s',
                auth: true,
                params: [{ name: 'id', label: 'Classroom ID (UUID)' }]
            },

            // Modules
            listModules: {
                method: 'GET',
                path: '/classrooms/{cid}/modules',
                description: 'Liste des modules d\'un cours',
                auth: true,
                params: [{ name: 'cid', label: 'Classroom ID (UUID)' }]
            },
            createModule: {
                method: 'POST',
                path: '/classrooms/{cid}/modules',
                description: 'Cr√©er un module',
                auth: true,
                params: [{ name: 'cid', label: 'Classroom ID (UUID)' }],
                body: { name: 'Module 1', category: 'Introduction' }
            },
            updateModule: {
                method: 'PUT',
                path: '/modules/{id}',
                description: 'Modifier un module',
                auth: true,
                params: [{ name: 'id', label: 'Module ID (UUID)' }],
                body: { name: 'Module modifi√©', category: 'Avanc√©' }
            },
            deleteModule: {
                method: 'DELETE',
                path: '/modules/{id}',
                description: 'Supprimer un module',
                auth: true,
                params: [{ name: 'id', label: 'Module ID (UUID)' }]
            },

            // Quizzes
            listQuizzes: {
                method: 'GET',
                path: '/modules/{mid}/quizzes',
                description: 'Liste des quiz d\'un module',
                auth: true,
                params: [{ name: 'mid', label: 'Module ID (UUID)' }]
            },
            createQuiz: {
                method: 'POST',
                path: '/modules/{mid}/quizzes',
                description: 'Cr√©er un quiz',
                auth: true,
                params: [{ name: 'mid', label: 'Module ID (UUID)' }],
                body: { name: 'Quiz 1', isActive: true, minScoreToUnlockNext: 12 }
            },
            updateQuiz: {
                method: 'PUT',
                path: '/quizzes/{id}',
                description: 'Modifier un quiz',
                auth: true,
                params: [{ name: 'id', label: 'Quiz ID (UUID)' }],
                body: { isActive: false, minScoreToUnlockNext: 10 }
            },
            deleteQuiz: {
                method: 'DELETE',
                path: '/quizzes/{id}',
                description: 'Supprimer un quiz',
                auth: true,
                params: [{ name: 'id', label: 'Quiz ID (UUID)' }]
            },

            // Questions
            listQuestions: {
                method: 'GET',
                path: '/quizzes/{quizId}/questions',
                description: 'Liste des questions d\'un quiz',
                auth: true,
                params: [{ name: 'quizId', label: 'Quiz ID (UUID)' }]
            },
            createQuestion: {
                method: 'POST',
                path: '/quizzes/{quizId}/questions',
                description: 'Ajouter une question',
                auth: true,
                params: [{ name: 'quizId', label: 'Quiz ID (UUID)' }],
                body: { 
                    type: 'MCQ', 
                    text: 'Quelle est la capitale de la France ?',
                    answers: [
                        { text: 'Paris', isCorrect: true },
                        { text: 'Lyon', isCorrect: false },
                        { text: 'Marseille', isCorrect: false }
                    ],
                    explanation: 'Paris est la capitale de la France.'
                }
            },
            updateQuestion: {
                method: 'PUT',
                path: '/questions/{questionId}',
                description: 'Modifier une question',
                auth: true,
                params: [{ name: 'questionId', label: 'Question ID (UUID)' }],
                body: { text: 'Question modifi√©e' }
            },
            deleteQuestion: {
                method: 'DELETE',
                path: '/questions/{questionId}',
                description: 'Supprimer une question',
                auth: true,
                params: [{ name: 'questionId', label: 'Question ID (UUID)' }]
            },

            // Media
            listMedia: {
                method: 'GET',
                path: '/media',
                description: 'Liste des m√©dias upload√©s',
                auth: true
            },
            uploadMedia: {
                method: 'POST',
                path: '/media',
                description: 'Uploader une image',
                auth: true,
                isFileUpload: true
            },
            deleteMedia: {
                method: 'DELETE',
                path: '/media/{mediaId}',
                description: 'Supprimer un m√©dia',
                auth: true,
                params: [{ name: 'mediaId', label: 'Media ID (UUID)' }]
            },
            orphanedMedia: {
                method: 'GET',
                path: '/media/orphaned',
                description: 'M√©dias non utilis√©s',
                auth: true
            },

            // Sessions
            startSession: {
                method: 'POST',
                path: '/sessions/start',
                description: 'D√©marrer une session de quiz',
                auth: true,
                body: { quizId: '' }
            },
            submitAnswer: {
                method: 'POST',
                path: '/sessions/{sessionId}/submit-answer',
                description: 'Soumettre une r√©ponse',
                auth: true,
                params: [{ name: 'sessionId', label: 'Session ID (UUID)' }],
                body: { questionId: '', answerId: '' }
            },
            finishSession: {
                method: 'POST',
                path: '/sessions/{sessionId}/finish',
                description: 'Terminer la session',
                auth: true,
                params: [{ name: 'sessionId', label: 'Session ID (UUID)' }]
            },
            reviewSession: {
                method: 'GET',
                path: '/sessions/{sessionId}/review',
                description: 'Correction d√©taill√©e',
                auth: true,
                params: [{ name: 'sessionId', label: 'Session ID (UUID)' }]
            },

            // Leitner
            leitnerStatus: {
                method: 'GET',
                path: '/classrooms/{cid}/leitner/status',
                description: 'Status des bo√Ætes Leitner',
                auth: true,
                params: [{ name: 'cid', label: 'Classroom ID (UUID)' }]
            },
            leitnerStart: {
                method: 'POST',
                path: '/classrooms/{cid}/leitner/start',
                description: 'D√©marrer r√©vision Leitner',
                auth: true,
                params: [{ name: 'cid', label: 'Classroom ID (UUID)' }],
                body: { questionCount: 10 }
            },
            leitnerSubmit: {
                method: 'POST',
                path: '/leitner/sessions/{sid}/submit-answer',
                description: 'Soumettre r√©ponse Leitner',
                auth: true,
                params: [{ name: 'sid', label: 'Session ID (UUID)' }],
                body: { questionId: '', answerId: '' }
            },
            leitnerFinish: {
                method: 'POST',
                path: '/leitner/sessions/{sid}/finish',
                description: 'Terminer session Leitner',
                auth: true,
                params: [{ name: 'sid', label: 'Session ID (UUID)' }]
            },
            leitnerReview: {
                method: 'GET',
                path: '/leitner/sessions/{sid}/review',
                description: 'Correction Leitner',
                auth: true,
                params: [{ name: 'sid', label: 'Session ID (UUID)' }]
            },

            // Stats & Progress
            studentStats: {
                method: 'GET',
                path: '/stats/student',
                description: 'Stats personnelles √©tudiant',
                auth: true
            },
            leaderboard: {
                method: 'GET',
                path: '/stats/leaderboard/{cid}',
                description: 'Classement du cours',
                auth: true,
                params: [{ name: 'cid', label: 'Classroom ID (UUID)' }]
            },
            dashboard: {
                method: 'GET',
                path: '/stats/dashboard/{cid}',
                description: 'Dashboard professeur',
                auth: true,
                params: [{ name: 'cid', label: 'Classroom ID (UUID)' }]
            },
            progressModule: {
                method: 'GET',
                path: '/progress/modules/{moduleId}',
                description: 'Progression sur un module',
                auth: true,
                params: [{ name: 'moduleId', label: 'Module ID (UUID)' }]
            },
            progressQuiz: {
                method: 'GET',
                path: '/progress/quizzes/{quizId}',
                description: 'Progression sur un quiz',
                auth: true,
                params: [{ name: 'quizId', label: 'Quiz ID (UUID)' }]
            },
            progressClassroom: {
                method: 'GET',
                path: '/progress/classroom/{cid}',
                description: 'Progression globale cours',
                auth: true,
                params: [{ name: 'cid', label: 'Classroom ID (UUID)' }]
            },
            progressStudent: {
                method: 'GET',
                path: '/progress/classroom/{cid}/student/{sid}',
                description: 'Progression d\'un √©tudiant (vue prof)',
                auth: true,
                params: [
                    { name: 'cid', label: 'Classroom ID (UUID)' },
                    { name: 'sid', label: 'Student ID (UUID)' }
                ]
            }
        };

        // State
        let currentEndpoint = null;
        let jwtToken = localStorage.getItem('jwtToken') || '';

        // DOM Elements
        const tokenInput = document.getElementById('jwtToken');
        const tokenStatus = document.getElementById('tokenStatus');
        const panel = document.getElementById('endpointPanel');

        // Init
        tokenInput.value = jwtToken;
        updateTokenStatus();

        tokenInput.addEventListener('input', (e) => {
            jwtToken = e.target.value;
            localStorage.setItem('jwtToken', jwtToken);
            updateTokenStatus();
        });

        function updateTokenStatus() {
            if (jwtToken) {
                tokenStatus.textContent = 'Token d√©fini';
                tokenStatus.className = 'token-status valid';
            } else {
                tokenStatus.textContent = 'Non connect√©';
                tokenStatus.className = 'token-status invalid';
            }
        }

        // Nav click handlers
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                item.classList.add('active');
                const endpointKey = item.dataset.endpoint;
                showEndpoint(endpointKey);
            });
        });

        function showEndpoint(key) {
            currentEndpoint = key;
            const ep = endpoints[key];
            
            let html = `
                <div class="endpoint-title">
                    <span class="method-badge method-${ep.method}">${ep.method}</span>
                    <span class="endpoint-path">${ep.path}</span>
                </div>
                <p style="color: #aaa; margin-bottom: 20px;">${ep.description}</p>
            `;

            // Path params
            if (ep.params && ep.params.length > 0) {
                html += `<div class="params-grid">`;
                ep.params.forEach(p => {
                    html += `
                        <div class="form-group">
                            <label>${p.label}</label>
                            <input type="text" id="param_${p.name}" placeholder="${p.name}">
                        </div>
                    `;
                });
                html += `</div>`;
            }

            // File upload
            if (ep.isFileUpload) {
                html += `
                    <div class="form-group">
                        <label>Fichier √† uploader</label>
                        <input type="file" id="fileInput" accept="image/*">
                    </div>
                `;
            }

            // Body
            if (ep.body) {
                html += `
                    <div class="form-group">
                        <label>Body (JSON)</label>
                        <textarea id="bodyInput">${JSON.stringify(ep.body, null, 2)}</textarea>
                    </div>
                `;
            }

            html += `
                <button class="btn-primary" onclick="executeRequest()">
                    Envoyer la requ√™te
                </button>
                
                <div class="response-section" id="responseSection" style="display: none;">
                    <div class="response-header">
                        <span id="responseStatus" class="response-status"></span>
                        <span id="responseTime" class="response-time"></span>
                    </div>
                    <div id="responseBody" class="response-body"></div>
                </div>
            `;

            panel.innerHTML = html;
        }

        async function executeRequest() {
            const ep = endpoints[currentEndpoint];
            let path = ep.path;

            // Replace path params
            if (ep.params) {
                ep.params.forEach(p => {
                    const value = document.getElementById(`param_${p.name}`).value;
                    path = path.replace(`{${p.name}}`, value);
                });
            }

            const url = API_BASE + path;
            const options = {
                method: ep.method,
                headers: {}
            };

            // Auth
            if (ep.auth && jwtToken) {
                options.headers['Authorization'] = `Bearer ${jwtToken}`;
            }

            // Body or File
            if (ep.isFileUpload) {
                const fileInput = document.getElementById('fileInput');
                if (fileInput.files[0]) {
                    const formData = new FormData();
                    formData.append('file', fileInput.files[0]);
                    options.body = formData;
                }
            } else if (ep.body) {
                options.headers['Content-Type'] = 'application/json';
                const bodyInput = document.getElementById('bodyInput');
                if (bodyInput) {
                    try {
                        options.body = bodyInput.value;
                    } catch (e) {
                        alert('JSON invalide dans le body');
                        return;
                    }
                }
            }

            const responseSection = document.getElementById('responseSection');
            const responseStatus = document.getElementById('responseStatus');
            const responseBody = document.getElementById('responseBody');
            const responseTime = document.getElementById('responseTime');

            responseSection.style.display = 'block';
            responseStatus.textContent = 'Chargement...';
            responseStatus.className = 'response-status';
            responseBody.textContent = '';

            const startTime = performance.now();

            try {
                const response = await fetch(url, options);
                const endTime = performance.now();
                const duration = Math.round(endTime - startTime);

                responseTime.textContent = `${duration}ms`;
                responseStatus.textContent = `${response.status} ${response.statusText}`;

                if (response.status >= 200 && response.status < 300) {
                    responseStatus.className = 'response-status status-2xx';
                } else if (response.status >= 400 && response.status < 500) {
                    responseStatus.className = 'response-status status-4xx';
                } else {
                    responseStatus.className = 'response-status status-5xx';
                }

                let data;
                const contentType = response.headers.get('content-type');
                if (contentType && contentType.includes('application/json')) {
                    data = await response.json();
                    responseBody.textContent = JSON.stringify(data, null, 2);
                    
                    // Auto-save token on login
                    if (currentEndpoint === 'login' && response.ok && data.token) {
                        tokenInput.value = data.token;
                        jwtToken = data.token;
                        localStorage.setItem('jwtToken', jwtToken);
                        updateTokenStatus();
                    }
                } else {
                    data = await response.text();
                    responseBody.textContent = data || '(Pas de contenu)';
                }
            } catch (error) {
                responseStatus.textContent = 'Erreur r√©seau';
                responseStatus.className = 'response-status status-5xx';
                responseBody.textContent = error.message;
            }
        }
    </script>
</body>
</html>
